| **Subtopic** | **Focus** | **Key Concepts** | **One-Line Recall** |
|---|---|---|---|
| **LC12.3.5.1 OAuth 2.0 Flows** | Protocol | Authorization code, client credentials | Different flows for different use cases. |
| **LC12.3.5.2 Provider Integration** | Setup | Google, GitHub, Auth0 | Integrate with OAuth providers. |
| **LC12.3.5.3 Token Management** | Handling | Access tokens, refresh tokens | Manage token lifecycle. |
| **LC12.3.5.4 Scopes** | Permissions | Request minimum scopes needed | Limit access to what's needed. |
| **LC12.3.5.5 PKCE** | Security | Proof Key for Code Exchange | Secure public clients. |

# OAuth: Third-Party Authentication

Integrating OAuth for secure authentication.

```python
from authlib.integrations.starlette_client import OAuth

oauth = OAuth()
oauth.register(
    name='google',
    client_id=GOOGLE_CLIENT_ID,
    client_secret=GOOGLE_CLIENT_SECRET,
    authorize_url='https://accounts.google.com/o/oauth2/auth',
    authorize_params=None,
    access_token_url='https://accounts.google.com/o/oauth2/token',
    access_token_params=None,
    refresh_token_url=None,
    redirect_uri='http://localhost:8000/auth/callback',
    client_kwargs={'scope': 'openid email profile'},
)

@app.get('/auth/login')
async def login(request):
    redirect_uri = request.url_for('auth_callback')
    return await oauth.google.authorize_redirect(request, redirect_uri)

@app.get('/auth/callback')
async def auth_callback(request):
    token = await oauth.google.authorize_access_token(request)
    user_info = token.get('userinfo')
    
    # Create or update user
    user = await user_service.get_or_create(user_info['email'])
    
    # Generate our JWT
    jwt_token = generate_token(user.id)
    
    return {"token": jwt_token}
```

**Quick Ref:** OAuth delegates authentication to trusted providers, use authorization code flow for web apps.
