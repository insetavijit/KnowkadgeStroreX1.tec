| **Subtopic**                                   | **Focus & Purpose**                     | **Key Concepts / Details**                                                    | **One-Line Recall**                                             |
| ---------------------------------------------- | --------------------------------------- | ----------------------------------------------------------------------------- | --------------------------------------------------------------- |
| **LC11.7.7.1 Language Translation**            | Porting                                 | Converting between programming languages                                      | Java to Python, JavaScript to TypeScript.                       |
| **LC11.7.7.2 Framework Migration**             | Modernizing                             | Moving between frameworks                                                     | Flask to FastAPI, jQuery to React.                              |
| **LC11.7.7.3 Version Upgrades**                | Updates                                 | Updating code for new versions                                                | Python 2 to 3, deprecated API updates.                          |
| **LC11.7.7.4 API Translation**                 | Integration                             | Converting between API styles                                                 | REST to GraphQL, sync to async.                                 |
| **LC11.7.7.5 Translation Quality**             | Verification                            | Ensuring translated code works                                                | Validate translation with tests.                                |

# Code Translation: Converting Between Languages

LLMs as code translators.

---

## 1. Language Translation

```python
translate_prompt = ChatPromptTemplate.from_template("""
Translate this {source_lang} code to {target_lang}:

```{source_lang}
{code}
```

Requirements:
- Use idiomatic {target_lang} patterns
- Maintain functionality exactly
- Add equivalent error handling
- Add type hints/annotations where applicable
""")

result = chain.invoke({
    "source_lang": "java",
    "target_lang": "python",
    "code": '''
public class Calculator {
    public int add(int a, int b) {
        return a + b;
    }
    
    public int divide(int a, int b) throws IllegalArgumentException {
        if (b == 0) {
            throw new IllegalArgumentException("Cannot divide by zero");
        }
        return a / b;
    }
}
    '''
})
```

---

## 2. Framework Migration

```python
migration_prompt = ChatPromptTemplate.from_template("""
Migrate this code from {source_framework} to {target_framework}:

```python
{code}
```

Ensure:
- Equivalent functionality
- Use {target_framework} best practices
- Handle differences in patterns
""")

# Flask to FastAPI
result = chain.invoke({
    "source_framework": "Flask",
    "target_framework": "FastAPI",
    "code": '''
from flask import Flask, request, jsonify

app = Flask(__name__)

@app.route('/users/<int:user_id>', methods=['GET'])
def get_user(user_id):
    user = db.get_user(user_id)
    if not user:
        return jsonify({"error": "Not found"}), 404
    return jsonify(user)
'''
})
```

---

## 3. Version Upgrades

```python
upgrade_prompt = ChatPromptTemplate.from_template("""
Upgrade this code from {old_version} to {new_version}:

```python
{code}
```

Update:
- Deprecated APIs
- New syntax features
- Breaking changes
- Type hints if upgrading to 3.9+
""")

# Python 2 to Python 3
result = chain.invoke({
    "old_version": "Python 2.7",
    "new_version": "Python 3.10",
    "code": '''
# Python 2 code
print "Hello World"
raw_input("Enter name: ")
xrange(10)
dict.iteritems()
'''
})
```

---

## 4. API Translation

```python
# Sync to Async
async_prompt = ChatPromptTemplate.from_template("""
Convert this synchronous code to async:

```python
{code}
```

Use:
- async/await syntax
- asyncio for concurrency
- aiohttp instead of requests
- Proper async patterns
""")

# REST to GraphQL
graphql_prompt = ChatPromptTemplate.from_template("""
Convert this REST endpoint to a GraphQL resolver:

REST endpoint:
```python
{code}
```

Create:
- Schema definition
- Resolver function
- Using Python graphene library
""")
```

---

## 5. Translation Validation

```python
class TranslationValidator:
    def __init__(self):
        self.llm = ChatOpenAI(model="gpt-4o")
    
    def translate_and_validate(self, code: str, source: str, target: str) -> dict:
        # Translate
        translated = self.translate(code, source, target)
        
        # Generate test cases from original
        tests = self.generate_tests(code, source)
        
        # Adapt tests for target language
        target_tests = self.translate(tests, source, target)
        
        # Validate (conceptually - actual execution needs sandbox)
        validation = self.validate_equivalence(code, translated, source, target)
        
        return {
            "translated_code": translated,
            "test_cases": target_tests,
            "validation_notes": validation
        }
    
    def validate_equivalence(self, original, translated, src, tgt) -> str:
        prompt = f"""
Compare these implementations for functional equivalence:

Original ({src}):
```{src}
{original}
```

Translated ({tgt}):
```{tgt}
{translated}
```

Identify any differences in:
1. Functionality
2. Edge cases
3. Error handling
4. Performance characteristics
"""
        return self.llm.invoke(prompt).content
```

---

## Quick Reference

| Translation | Considerations |
|-------------|----------------|
| **Language** | Idioms, standard library diffs |
| **Framework** | Conventions, middleware |
| **Version** | Deprecations, new features |
| **API Style** | Sync/async, REST/GraphQL |
