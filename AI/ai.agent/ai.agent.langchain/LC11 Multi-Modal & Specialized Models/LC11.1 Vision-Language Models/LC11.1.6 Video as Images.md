| **Subtopic**                                   | **Focus & Purpose**                     | **Key Concepts / Details**                                                    | **One-Line Recall**                                             |
| ---------------------------------------------- | --------------------------------------- | ----------------------------------------------------------------------------- | --------------------------------------------------------------- |
| **LC11.1.6.1 Frame Extraction**                | Strategy                                | Extracting key frames from video files                                        | Sample frames from video at regular intervals.                  |
| **LC11.1.6.2 Sampling Strategies**             | Methods                                 | Every Nth frame, scene detection, keyframes                                   | Choose sampling rate based on video type.                       |
| **LC11.1.6.3 Video as Image Sequence**         | Processing                              | Treating extracted frames as multi-image input                                | Videos become image sequences for VLMs.                         |
| **LC11.1.6.4 Native Video Support**            | Provider-specific                       | Gemini's native video input (mp4)                                             | Gemini accepts video directly; others need frames.              |
| **LC11.1.6.5 Action/Event Detection**          | Use case                                | Detecting events across frames                                                | Use frame sequences to detect actions over time.                |

# Video as Images: Frame Sampling

Most VLMs don't accept video directly.
The workaround: **extract frames** and process as image sequences.

---

## 1. Frame Extraction (OpenCV)

```python
import cv2
import base64

def extract_frames(video_path: str, sample_rate: int = 30) -> list[str]:
    """Extract every Nth frame as base64."""
    frames = []
    cap = cv2.VideoCapture(video_path)
    
    frame_count = 0
    while cap.isOpened():
        ret, frame = cap.read()
        if not ret:
            break
        
        if frame_count % sample_rate == 0:
            # Encode as JPEG
            _, buffer = cv2.imencode('.jpg', frame)
            b64 = base64.b64encode(buffer).decode()
            frames.append(f"data:image/jpeg;base64,{b64}")
        
        frame_count += 1
    
    cap.release()
    return frames
```

---

## 2. Sampling Strategies

| Strategy | When to Use |
|----------|-------------|
| **Every Nth Frame** | General purpose (e.g., every 30th = 1fps) |
| **Scene Detection** | Narrative videos (use PySceneDetect) |
| **Motion-Based** | Surveillance, sports (high motion areas) |
| **Fixed Count** | Limit to e.g. 10 equally-spaced frames |

---

## 3. Video Analysis Chain

```python
frames = extract_frames("demo.mp4", sample_rate=60)

message = HumanMessage(
    content=[
        {"type": "text", "text": "These are frames from a video. Describe what's happening."},
        *[{"type": "image_url", "image_url": {"url": f}} for f in frames[:10]]
    ]
)

response = llm.invoke([message])
```

**Warning**: Limit to ~10 frames to stay within token limits.

---

## 4. Native Video Support (Gemini)

Gemini 1.5 accepts video files directly:

```python
from langchain_google_genai import ChatGoogleGenerativeAI

llm = ChatGoogleGenerativeAI(model="gemini-1.5-pro")

# For Gemini, you can upload video directly via their File API
# and reference it in prompts
```

This avoids manual frame extraction but is provider-specific.

---

## 5. Action Detection Example

```python
prompt = """
These are 10 frames from a security camera.
1. Identify any unusual activity
2. List timestamps where activity occurs
3. Describe the action
"""

# frames = [frame_0, frame_3, frame_6, ...]
# Each frame represents ~1 second of video
```

---

## Quick Reference

| Aspect | Approach |
|--------|----------|
| **Extraction** | OpenCV, FFmpeg |
| **Sampling** | 1 FPS typical |
| **Limit** | ~10 frames per call |
| **Native** | Gemini only (currently) |
