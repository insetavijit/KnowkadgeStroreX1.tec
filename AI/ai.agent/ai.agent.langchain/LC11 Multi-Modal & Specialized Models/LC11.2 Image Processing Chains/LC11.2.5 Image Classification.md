| **Subtopic**                                   | **Focus & Purpose**                     | **Key Concepts / Details**                                                    | **One-Line Recall**                                             |
| ---------------------------------------------- | --------------------------------------- | ----------------------------------------------------------------------------- | --------------------------------------------------------------- |
| **LC11.2.5.1 VLM Classification**              | Zero-shot                               | Using VLMs to classify images by category                                     | VLMs can classify images without training.                      |
| **LC11.2.5.2 Category Lists**                  | Constrained output                      | Providing fixed list of classes                                               | Constrain output to known categories.                           |
| **LC11.2.5.3 Confidence Scoring**              | Uncertainty                             | Getting confidence levels with classifications                                | Ask for confidence scores alongside labels.                     |
| **LC11.2.5.4 Multi-Label Classification**      | Multiple tags                           | Assigning multiple categories to images                                       | Images can have multiple labels (not exclusive).                |
| **LC11.2.5.5 Classification Chain**            | LCEL pattern                            | Building reusable classification pipelines                                    | Build classification chains with structured output.             |

# Image Classification: Categorizing Visual Content

Assign categories to images using VLMsâ€”no training required.

---

## 1. VLM Zero-Shot Classification

VLMs can classify images without fine-tuning:

```python
message = HumanMessage(
    content=[
        {"type": "text", "text": "What type of animal is in this image?"},
        {"type": "image_url", "image_url": {"url": image_url}}
    ]
)

category = llm.invoke([message]).content
# "This is a golden retriever dog"
```

---

## 2. Constrained Categories

For consistent output, provide the allowed classes:

```python
prompt = """
Classify this image into ONE of these categories:
- cat
- dog
- bird
- other

Respond with only the category name, nothing else.
"""
```

**Output**: `dog`

---

## 3. Confidence Scoring

Ask for confidence alongside the label:

```python
from pydantic import BaseModel

class Classification(BaseModel):
    category: str
    confidence: float  # 0.0 to 1.0
    reason: str

prompt = f"""
Classify this image.
{parser.get_format_instructions()}
"""
```

**Output**:
```json
{
  "category": "dog",
  "confidence": 0.95,
  "reason": "Clear image of a golden retriever puppy"
}
```

---

## 4. Multi-Label Classification

When images can have multiple categories:

```python
class MultiLabel(BaseModel):
    labels: list[str]
    primary_label: str

prompt = """
Tag this image with ALL relevant labels from:
[outdoor, indoor, people, animals, nature, urban, food, technology]

Return all that apply.
"""
```

**Output**:
```json
{
  "labels": ["outdoor", "animals", "nature"],
  "primary_label": "animals"
}
```

---

## 5. Classification Chain

```python
from pydantic import BaseModel
from langchain_core.output_parsers import PydanticOutputParser

class ImageCategory(BaseModel):
    category: str
    confidence: float

parser = PydanticOutputParser(pydantic_object=ImageCategory)

CATEGORIES = ["product", "lifestyle", "portrait", "landscape", "other"]

def build_classify_message(inputs: dict):
    prompt = f"""
Classify this image into one of: {CATEGORIES}
{parser.get_format_instructions()}
    """
    return [HumanMessage(content=[
        {"type": "text", "text": prompt},
        {"type": "image_url", "image_url": {"url": inputs["image_url"]}}
    ])]

classification_chain = (
    RunnableLambda(build_classify_message)
    | llm
    | parser
)

result: ImageCategory = classification_chain.invoke({
    "image_url": "https://example.com/product.jpg"
})
```

---

## Quick Reference

| Pattern | Approach |
|---------|----------|
| **Single Label** | "Choose ONE from list" |
| **Multi-Label** | "Select ALL that apply" |
| **Confidence** | Return score 0-1 with label |
| **Constrained** | Provide exact category list |
