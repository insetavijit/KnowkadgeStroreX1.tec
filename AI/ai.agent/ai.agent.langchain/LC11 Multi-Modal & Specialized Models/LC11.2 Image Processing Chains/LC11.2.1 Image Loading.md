| **Subtopic**                                   | **Focus & Purpose**                     | **Key Concepts / Details**                                                    | **One-Line Recall**                                             |
| ---------------------------------------------- | --------------------------------------- | ----------------------------------------------------------------------------- | --------------------------------------------------------------- |
| **LC11.2.1.1 Local File Loading**              | Basic                                   | Reading images from disk using Python                                         | Use PIL or OpenCV to load local images.                         |
| **LC11.2.1.2 URL Loading**                     | Remote                                  | Fetching images from HTTP URLs                                                | Use requests to download remote images.                         |
| **LC11.2.1.3 File Format Support**             | Compatibility                           | JPEG, PNG, WebP, GIF, BMP, TIFF                                               | Most VLMs support JPEG, PNG, WebP, GIF.                         |
| **LC11.2.1.4 Cloud Storage**                   | Enterprise                              | Loading from S3, GCS, Azure Blob                                              | Use boto3, google-cloud-storage for cloud images.               |
| **LC11.2.1.5 Image Validation**                | Safety                                  | Checking file type, size, dimensions                                          | Validate images before processing.                              |

# Image Loading: Getting Images Into Your Pipeline

Before processing images, you need to load them from various sources.

---

## 1. Local File Loading (PIL)

```python
from PIL import Image
import io
import base64

def load_local_image(path: str) -> Image.Image:
    """Load image from local file system."""
    return Image.open(path)

def image_to_base64(img: Image.Image, format: str = "JPEG") -> str:
    """Convert PIL Image to base64 string."""
    buffer = io.BytesIO()
    img.save(buffer, format=format)
    return base64.b64encode(buffer.getvalue()).decode()
```

---

## 2. URL Loading

```python
import requests
from PIL import Image
from io import BytesIO

def load_image_from_url(url: str) -> Image.Image:
    """Fetch and load image from URL."""
    response = requests.get(url, timeout=10)
    response.raise_for_status()
    return Image.open(BytesIO(response.content))
```

**Tip**: Always set timeouts to avoid hanging.

---

## 3. Supported Formats

| Format | Extension | Notes |
|--------|-----------|-------|
| **JPEG** | .jpg, .jpeg | Best for photos |
| **PNG** | .png | Supports transparency |
| **WebP** | .webp | Modern, smaller files |
| **GIF** | .gif | VLMs see first frame only |
| **BMP** | .bmp | Large, rarely used |

---

## 4. Cloud Storage Loading

**AWS S3**:
```python
import boto3

s3 = boto3.client("s3")

def load_from_s3(bucket: str, key: str) -> bytes:
    obj = s3.get_object(Bucket=bucket, Key=key)
    return obj["Body"].read()
```

**Google Cloud Storage**:
```python
from google.cloud import storage

def load_from_gcs(bucket: str, blob_name: str) -> bytes:
    client = storage.Client()
    bucket = client.bucket(bucket)
    blob = bucket.blob(blob_name)
    return blob.download_as_bytes()
```

---

## 5. Image Validation

```python
def validate_image(path: str, max_size_mb: int = 20) -> bool:
    """Validate image file before processing."""
    import os
    
    # Check file exists
    if not os.path.exists(path):
        raise FileNotFoundError(path)
    
    # Check file size
    size_mb = os.path.getsize(path) / (1024 * 1024)
    if size_mb > max_size_mb:
        raise ValueError(f"Image too large: {size_mb:.1f}MB > {max_size_mb}MB")
    
    # Check it's a valid image
    try:
        img = Image.open(path)
        img.verify()  # Validates without loading full image
        return True
    except Exception:
        raise ValueError("Invalid image file")
```

---

## Quick Reference

| Source | Method |
|--------|--------|
| **Local** | `PIL.Image.open()` |
| **URL** | `requests.get()` |
| **S3** | `boto3.client("s3")` |
| **GCS** | `google.cloud.storage` |
