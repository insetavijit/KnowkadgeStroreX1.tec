| **Subtopic**                                   | **Focus & Purpose**                     | **Key Concepts / Details**                                                    | **One-Line Recall**                                             |
| ---------------------------------------------- | --------------------------------------- | ----------------------------------------------------------------------------- | --------------------------------------------------------------- |
| **LC11.4.3.1 TTS Providers**                   | Services                                | OpenAI TTS, ElevenLabs, Google Cloud TTS                                      | Multiple TTS providers with different voices.                   |
| **LC11.4.3.2 OpenAI TTS API**                  | Integration                             | Using OpenAI's text-to-speech API                                             | OpenAI TTS offers high-quality voices.                          |
| **LC11.4.3.3 Voice Selection**                 | Customization                           | Choosing voice characteristics                                                | Select voices by gender, accent, style.                         |
| **LC11.4.3.4 TTS Chain**                       | LCEL pattern                            | Building LLM-to-speech pipelines                                              | Generate text with LLM, speak with TTS.                         |
| **LC11.4.3.5 Audio Output Handling**           | Files                                   | Saving and streaming generated audio                                          | Save TTS output as mp3/wav files.                               |

# Text-to-Speech: Voice Synthesis

Convert text to natural-sounding speech.

---

## 1. TTS Provider Comparison

| Provider | Quality | Voices | Cost |
|----------|---------|--------|------|
| **OpenAI TTS** | Excellent | 6 | $15/1M chars |
| **ElevenLabs** | Best | 100s + clone | $5-330/mo |
| **Google Cloud** | Good | 200+ | $4/1M chars |
| **Azure** | Good | 400+ | $4/1M chars |
| **Coqui TTS** | Good | OSS | Free |

---

## 2. OpenAI TTS API

```python
from openai import OpenAI
from pathlib import Path

client = OpenAI()

def text_to_speech(text: str, voice: str = "alloy") -> bytes:
    """Convert text to speech audio."""
    response = client.audio.speech.create(
        model="tts-1",  # or "tts-1-hd" for higher quality
        voice=voice,    # alloy, echo, fable, onyx, nova, shimmer
        input=text
    )
    return response.content

# Save to file
audio_bytes = text_to_speech("Hello, this is a test.")
Path("output.mp3").write_bytes(audio_bytes)
```

---

## 3. Voice Selection

**OpenAI Voices**:
| Voice | Characteristics |
|-------|-----------------|
| **alloy** | Neutral, versatile |
| **echo** | Male, warm |
| **fable** | British, narrative |
| **onyx** | Male, deep |
| **nova** | Female, friendly |
| **shimmer** | Female, clear |

**ElevenLabs** (more options):
```python
from elevenlabs import ElevenLabs

client = ElevenLabs(api_key="...")

audio = client.generate(
    text="Hello world",
    voice="Rachel",  # Or use voice_id
    model="eleven_multilingual_v2"
)
```

---

## 4. TTS Chain (LLM â†’ Speech)

```python
from langchain_openai import ChatOpenAI
from langchain_core.runnables import RunnableLambda

llm = ChatOpenAI()

def speak(text: str) -> bytes:
    response = client.audio.speech.create(
        model="tts-1",
        voice="nova",
        input=text
    )
    return response.content

tts_chain = (
    prompt
    | llm
    | StrOutputParser()
    | RunnableLambda(speak)
)

# Generate and speak response
audio = tts_chain.invoke({"question": "What is machine learning?"})
Path("response.mp3").write_bytes(audio)
```

---

## 5. Streaming TTS

For long text, stream the audio:

```python
from openai import OpenAI

client = OpenAI()

def stream_tts(text: str, output_path: str):
    """Stream TTS to file as it generates."""
    response = client.audio.speech.create(
        model="tts-1",
        voice="alloy",
        input=text
    )
    
    # Stream to file
    response.stream_to_file(output_path)

# Or get streaming response
with client.audio.speech.with_streaming_response.create(
    model="tts-1",
    voice="alloy",
    input="Long text here..."
) as response:
    for chunk in response.iter_bytes():
        # Process audio chunks as they arrive
        pass
```

---

## Quick Reference

| Task | Approach |
|------|----------|
| **Simple TTS** | OpenAI API |
| **Voice Cloning** | ElevenLabs |
| **Multilingual** | Google/Azure |
| **Offline** | Coqui TTS |
| **Streaming** | `stream_to_file()` |
