| **Subtopic**                                   | **Focus & Purpose**                     | **Key Concepts / Details**                                                    | **One-Line Recall**                                             |
| ---------------------------------------------- | --------------------------------------- | ----------------------------------------------------------------------------- | --------------------------------------------------------------- |
| **LC10.3.1.1 Definition & Purpose**            | Why use TypedDict                       | Lightweight structural typing, Dict validation, IDE autocompletion            | TypedDict gives dictionary keys structural definition.          |
| **LC10.3.1.2 Defining Interfaces**             | Defining Input/Output                   | Class-based syntax, functional syntax, required vs optional keys              | Use TypedDict to define the shape of chain inputs.              |
| **LC10.3.1.3 Integration with Runnables**      | Using in chains                         | Annotating InputType, passing to prompts, type-safe intermediate steps        | Annotate Runnables with TypedDict for type safety.              |
| **LC10.3.1.4 Total=False**                     | Optional keys                           | Partial dictionaries, flexible inputs, progressive construction               | Use Total=False for dicts with optional keys.                   |
| **LC10.3.1.5 Alternatives**                    | dict vs TypedDict                       | When to use raw dicts vs TypedDict for clarity                                | TypedDict is better than raw dicts for public interfaces.       |

# TypedDict Usage: The "Just Enough" Structure

In Python, dictionaries are everywhere. But raw dicts (`Dict[str, Any]`) are **type-unsafe**. You don't know what keys they have. `TypedDict` bridges the gap, allowing you to define the *shape* of a dictionary while keeping the runtime overhead zero.

---

## 1. Definition and Purpose

`TypedDict` allows you to declare: "This dictionary MUST have these keys with these types."

```python
from typing import TypedDict

class RAGInput(TypedDict):
    question: str
    chat_history: list[str]
    mode: str
```

At runtime, it's just a normal `dict`.
At development time (IDE/Mypy), it's a strict contract.

**Key Insight**: It gives you "Schema-lite" without the complexity of Pydantic.

---

## 2. Defining Interfaces

Use class-based syntax for readability.

```python
# Required keys
class UserProfile(TypedDict):
    id: int
    name: str

# Use it
user: UserProfile = {"id": 1, "name": "Alice"}  # ✅
user: UserProfile = {"id": 1}                   # ❌ Missing 'name'
```

### Functional Syntax

For quick one-offs:
```python
Point = TypedDict("Point", {"x": int, "y": int})
```

---

## 3. Integration with Runnables

This is where LCEL shines. You can annotate your custom Runnables with `TypedDict`.

```python
from langchain_core.runnables import RunnableLambda

class SearchInput(TypedDict):
    query: str
    context: str

def search_func(input: SearchInput) -> str:
    # IDE knows 'input' has .query and .context
    return f"Searching for {input['query']} in {input['context']}"

# The Runnable infers InputType = SearchInput
search_chain = RunnableLambda(search_func)
```

Now, `search_chain.InputType` reports `SearchInput`.

---

## 4. Total=False (Optional Keys)

Sometimes keys are optional.

```python
class Options(TypedDict, total=False):
    timeout: int
    retries: int

# Valid
opt1: Options = {"timeout": 10}
opt2: Options = {}
```

Use this for **configuration dictionaries** passed through a chain.

---

## 5. Alternatives: When to use what?

| Feature | `dict` | `TypedDict` | `Pydantic` |
|---------|--------|-------------|------------|
| **Runtime Check** | No | No | **Yes** |
| **IDE Autocomplete** | No | **Yes** | **Yes** |
| **Performance** | Fast | Fast | Slower |
| **Flexibility** | High | Medium | Low |

**Rule of Thumb**:
*   Internal chain logic steps? -> **TypedDict**
*   Public API boundary? -> **Pydantic**
*   Quick prototyping? -> **dict**

---

## Quick Reference

| Concept | Key Point |
|---------|-----------|
| **TypedDict** | Structural typing for dictionaries |
| **IDE Support** | Enables autocompletion for dict keys |
| **Zero Overhead** | Compiles to standard dict at runtime |
| **total=False** | Allows optional keys |
| **Usage** | Best for internal chain data shapes |
